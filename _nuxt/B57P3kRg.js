import{_ as z}from"./Bf8G-H8T.js";import{_ as E}from"./CljQtoxh.js";import{p as O,m as W}from"./D4nOid8d.js";import{f as q}from"./t2QABOX-.js";import{e as B,p as R,g as v,u as G,r as y,o as n,c as l,a as s,s as g,j as e,b as m,l as d,H as F,F as b,I as J,h as K,m as N,w as p,k as A,t as f}from"./Dg8MPD_X.js";import{_ as w}from"./DlAUqK2U.js";import{u as Q,c as T}from"./CSXz465P.js";import{u as X}from"./ZXiQ0iUd.js";import"./DHLrws4d.js";const Y={class:"profile"},Z={class:"container"},ss={class:"nav"},es={key:0},ts={key:0},os={class:"profile_content"},ns=B({__name:"Profile",setup(C){const{$viewport:c}=R(),_=v(()=>c.matches("mobile_small","mobile"));G({title:()=>"Profile"});const i=y("favorites");return(a,t)=>(n(),l(b,null,[s("div",Y,[s("div",Z,[t[4]||(t[4]=s("h2",null,"Мой аккаунт",-1)),s("div",ss,[s("button",{class:g(["nav-link",{active_border:e(i)==="favorites"}]),id:"favorites",onClick:t[0]||(t[0]=h=>i.value="favorites")},[m(e(q)),t[2]||(t[2]=s("span",null,"Избранные",-1)),e(_)?d("",!0):(n(),l("span",es,"фильмы"))],2),s("button",{class:g(["nav-link",{active_border:e(i)==="settings"}]),id:"settings",onClick:t[1]||(t[1]=h=>i.value="settings")},[m(e(O)),t[3]||(t[3]=s("span",null,"Настройка",-1)),e(_)?d("",!0):(n(),l("span",ts,"аккаунта"))],2)])])]),s("div",os,[s("div",{class:g(["container",{container_active:e(i)==="favorites"}])},[e(i)==="favorites"?F(a.$slots,"favorites",{key:0},void 0):d("",!0),e(i)==="settings"?F(a.$slots,"settings",{key:1},void 0):d("",!0)],2)])],64))}}),is=w(ns,[["__scopeId","data-v-db0b6bf6"]]),as=["src"],rs={key:1,class:"movie_list"},ls=["src"],cs=["onClick"],_s={class:"wrapper"},us={class:"user_info"},ms={class:"user_info-item"},ps={class:"user_info-icon"},ds={class:"user_info-value"},fs={class:"user_info-item"},vs={class:"user_info-icon"},hs={class:"user_info-value"},ks=B({__name:"ProfileData",setup(C){const c=Q(),_=X(),i=J(),a=v(()=>c.user),t=y(null),{$viewport:h}=R(),V=v(()=>h.matches("mobile_small"));K(async()=>{try{await c.profile()}catch(r){console.error("Ошибка загрузки профиля:",r)}await x()});const D=v(()=>{var r;return((r=a.value)==null?void 0:r.favorites)||[]}),k=y([]),x=async()=>{const r=D.value.map(async u=>(await _.fetchMovieId(u),{id:u,poster:_.moviePoster}));k.value=await Promise.all(r)},L=async r=>{await c.removeFavorites(r),await x()},H=async()=>{await c.logout(),i.push("/")};return(r,u)=>{const P=z,U=E,j=is;return n(),N(j,null,{favorites:p(()=>[e(V)?(n(),N(U,{key:0},{default:p(()=>[s("swiper-container",{class:"movie_list",ref_key:"containerRef",ref:t,loop:!0,"slides-per-view":"auto","space-between":40,"slides-offset-before":20},[(n(!0),l(b,null,A(e(k),o=>(n(),l("swiper-slide",{class:"movie_item",key:o.id,style:{width:"224px"}},[m(P,{class:"movie_link",to:`/movies/${o.id}`},{default:p(()=>[s("img",{src:o.poster,alt:"Movie Poster"},null,8,as)]),_:2},1032,["to"])]))),128))],512)]),_:1})):(n(),l("ul",rs,[(n(!0),l(b,null,A(e(k),o=>(n(),l("li",{class:"movie_item",key:o.id},[m(P,{class:"movie_link",to:`/movies/${o.id}`},{default:p(()=>[s("img",{src:o.poster,alt:"Movie Poster"},null,8,ls)]),_:2},1032,["to"]),s("button",{class:"movie_remove",onClick:$=>L(o.id)},[m(e(T))],8,cs)]))),128))]))]),settings:p(()=>{var o,$,S,I,M;return[s("div",_s,[s("ul",us,[s("li",ms,[s("span",ps,f(`${(o=e(a))==null?void 0:o.name[0].charAt(0).toUpperCase()}${($=e(a))==null?void 0:$.surname[0].charAt(0).toUpperCase()}`),1),u[0]||(u[0]=s("span",{class:"user_info-title"},"Имя Фамилия",-1)),s("span",ds,f((S=e(a))==null?void 0:S.name)+" "+f((I=e(a))==null?void 0:I.surname),1)]),s("li",fs,[s("span",vs,[m(e(W))]),u[1]||(u[1]=s("span",{class:"user_info-title"},"Электронная почта",-1)),s("span",hs,f((M=e(a))==null?void 0:M.email),1)])]),s("button",{class:"logout-button",onClick:H}," Выйти из аккаунта ")])]}),_:1})}}}),$s=w(ks,[["__scopeId","data-v-458eaed8"]]),gs={};function ys(C,c){const _=$s;return n(),l("div",null,[m(_)])}const Ns=w(gs,[["render",ys],["__scopeId","data-v-92e3c052"]]);export{Ns as default};
