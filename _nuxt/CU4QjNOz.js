import{u as x,_ as L}from"./s9-G_ldQ.js";import{_ as T}from"./PiI8twW9.js";import{u as z,_ as D,c as R}from"./DebZ_aZh.js";import{_ as Y}from"./DoweZdBC.js";import{c as j,u as q}from"./DEfN9ERZ.js";import{e as M,o as n,c,a as o,t as u,b as m,i as e,k as l,q as E,f as U,r as G,g,j as p,F as w,l as J,s as b,w as K,d as O}from"./Z1nLE7KB.js";import{_ as Q}from"./DlAUqK2U.js";import{f as W}from"./B1uqA_Xj.js";const X={key:0,class:"modal-player"},Z={class:"video-player"},ee=["src","videoId"],te=M({__name:"VideoPlayer",props:{videoId:{},title:{},close:{type:Function}},setup(f){return(r,v)=>r.videoId?(n(),c("div",X,[o("div",Z,[o("h3",null,u(r.title),1),o("iframe",{src:`https://www.youtube.com/embed/${r.videoId}?controls=0&autoplay=1&mute=1`,videoId:r.videoId},null,8,ee),o("button",{onClick:v[0]||(v[0]=(...i)=>r.close&&r.close(...i))},[m(e(j))])])])):l("",!0)}}),oe=Q(te,[["__scopeId","data-v-e196013f"]]),se={xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24"};function ne(f,r){return n(),c("svg",se,r[0]||(r[0]=[E('<defs><clipPath id="a"><rect width="23" height="23" fill-opacity="0" rx="-.5" transform="translate(.5 .5)"></rect></clipPath></defs><rect width="23" height="23" fill="none" rx="-.5" transform="translate(.5 .5)"></rect><g clip-path="url(#a)"><path d="M12 4c2.74 0 5.17 1.38 6.61 3.5H16v2h6v-6h-2v2.49A10.01 10.01 0 0 0 12 2C6.47 2 2 6.47 2 12h2c0-4.42 3.58-8 8-8m8 8c0 4.41-3.59 8-8 8-2.75 0-5.18-1.39-6.62-3.5H8v-2H2v6h2V18a9.99 9.99 0 0 0 8 4c5.52 0 10-4.48 10-10z"></path></g>',3)]))}const re={render:ne},ae={class:"container"},ie={key:1,class:"error_global"},le={key:2,class:"movie"},ce={class:"movie_backdrop"},ue={class:"movie_content"},de={class:"movie_content-top"},ve={class:"movie_content-center"},_e={class:"movie_line"},be=M({__name:"Movie",props:{movieProps:{},isLoading:{type:Boolean},error:{},refreshMovie:{type:Function}},setup(f){const r=z(),v=U(),i=q(),h=G(""),C=f,s=g(()=>C.movieProps||null),_=g(()=>v.path==="/"),{data:F,refresh:I,error:y}=x("userFavorites",async()=>{if(i.user){await i.profile();const t=i.user;return(t==null?void 0:t.favorites)||[]}}),k=g(()=>{var t,a;return((a=F.value)==null?void 0:a.includes(((t=s.value)==null?void 0:t.id.toString())||""))||!1}),S=async t=>{if(i.user)try{k.value?await i.removeFavorites(t):await i.addFavorites(t),await I()}catch(a){console.error("Ошибка при добавления/удаления в избранное",a)}else r.open()},$=()=>{var t;s.value&&(h.value=((t=s.value)==null?void 0:t.trailerYouTubeId)||"")},V=()=>{h.value=""};return(t,a)=>{const P=L,H=T,N=D,A=Y,B=oe;return n(),c(w,null,[o("div",ae,[t.isLoading?(n(),p(P,{key:0})):l("",!0),e(y)?(n(),c("div",ie," Произошла ошибка при загрузке фильма: "+u(e(y).message),1)):l("",!0),e(s)?(n(),c("section",le,[o("div",ce,[m(H,{src:e(s).backdropUrl,alt:"Backdrop"},null,8,["src"])]),o("div",ue,[o("div",de,[e(s)?(n(),p(N,{key:0,class:"movie_rating",rating:e(s).tmdbRating,customClass:"star_svg"},null,8,["rating"])):l("",!0),o("span",null,u(e(s).releaseYear),1),(n(!0),c(w,null,J(e(s).genres,d=>(n(),c("span",{key:d},u(d),1))),128)),o("span",null,u(("convertMinutesToHoursAndMinutes"in t?t.convertMinutesToHoursAndMinutes:e(R))(e(s).runtime)),1)]),o("div",ve,[o("h2",null,u(e(s).title),1),o("p",null,u(e(s).plot),1)]),o("div",{class:b(["movie_content-bottom",{"page-movie":!e(_),"page-cover":e(_)}])},[o("button",{onClick:$,class:"movie_trailer"}," Треилер "),o("div",_e,[e(_)?(n(),p(A,{key:0,to:`/movies/${e(s).id}`},{default:K(()=>a[2]||(a[2]=[O(" О фильме")])),_:1},8,["to"])):l("",!0),o("button",{class:"favorite_btn",onClick:a[0]||(a[0]=d=>S(e(s).id))},[m(e(W),{class:b(["favorite",{favoriteFill:e(k)}])},null,8,["class"])]),e(_)?(n(),c("button",{key:1,class:"update_btn",onClick:a[1]||(a[1]=(...d)=>t.refreshMovie&&t.refreshMovie(...d))},[m(e(re),{class:"update_svg"})])):l("",!0)])],2)])])):l("",!0)]),e(s)?(n(),p(B,{key:0,videoId:e(h),title:e(s).title,close:V},null,8,["videoId","title"])):l("",!0)],64)}}});export{be as _};
