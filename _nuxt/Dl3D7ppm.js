import{_ as O}from"./DTZrjyt7.js";import{_ as q}from"./BexR3h6I.js";import{p as G,m as J}from"./CV8QkT9l.js";import{f as K}from"./jDes9ai6.js";import{e as R,p as W,g as f,u as Q,r as h,o as i,c,a as s,s as y,j as e,b as d,l as p,H as F,F as b,I as T,h as L,i as X,m as N,w as m,k as A,t as v}from"./DvgaWAKj.js";import{_ as C}from"./DlAUqK2U.js";import{u as Y,c as Z}from"./_cARhDiT.js";import{u as ss}from"./ClYwyyRn.js";import"./DHLrws4d.js";const es={class:"profile"},ts={class:"container"},os={class:"nav"},ns={key:0},is={key:0},rs={class:"profile_content"},as=R({__name:"Profile",setup(P){const{$viewport:_}=W(),u=f(()=>_.matches("mobile_small","mobile"));Q({title:()=>"Profile"});const r=h("favorites");return(a,t)=>(i(),c(b,null,[s("div",es,[s("div",ts,[t[4]||(t[4]=s("h2",null,"Мой аккаунт",-1)),s("div",os,[s("button",{class:y(["nav-link",{active_border:e(r)==="favorites"}]),id:"favorites",onClick:t[0]||(t[0]=w=>r.value="favorites")},[d(e(K)),t[2]||(t[2]=s("span",null,"Избранные",-1)),e(u)?p("",!0):(i(),c("span",ns,"фильмы"))],2),s("button",{class:y(["nav-link",{active_border:e(r)==="settings"}]),id:"settings",onClick:t[1]||(t[1]=w=>r.value="settings")},[d(e(G)),t[3]||(t[3]=s("span",null,"Настройка",-1)),e(u)?p("",!0):(i(),c("span",is,"аккаунта"))],2)])])]),s("div",rs,[s("div",{class:y(["container",{container_active:e(r)==="favorites"}])},[e(r)==="favorites"?F(a.$slots,"favorites",{key:0},void 0):p("",!0),e(r)==="settings"?F(a.$slots,"settings",{key:1},void 0):p("",!0)],2)])],64))}}),ls=C(as,[["__scopeId","data-v-db0b6bf6"]]),cs=["slides-per-view"],_s=["src"],us={key:1,class:"movie_list"},ds=["src"],ms=["onClick"],ps={class:"wrapper"},vs={class:"user_info"},fs={class:"user_info-item"},hs={class:"user_info-icon"},ws={class:"user_info-value"},ks={class:"user_info-item"},$s={class:"user_info-icon"},gs={class:"user_info-value"},ys=R({__name:"ProfileData",setup(P){const _=Y(),u=ss(),r=T(),a=f(()=>_.user),t=h(null),{$viewport:w}=W(),z=f(()=>w.matches("mobile_small")),S=h(0),k=()=>{const o=window.innerWidth,l=264;S.value=o/l};L(()=>{k(),window.addEventListener("resize",k)}),X(()=>{window.removeEventListener("resize",k)}),L(async()=>{try{await _.profile()}catch(o){console.error("Ошибка загрузки профиля:",o)}await x()});const D=f(()=>{var o;return((o=a.value)==null?void 0:o.favorites)||[]}),$=h([]),x=async()=>{const o=D.value.map(async l=>(await u.fetchMovieId(l),{id:l,poster:u.moviePoster}));$.value=await Promise.all(o)},E=async o=>{await _.removeFavorites(o),await x()},U=async()=>{await _.logout(),r.push("/")};return(o,l)=>{const I=O,H=q,j=ls;return i(),N(j,null,{favorites:m(()=>[e(z)?(i(),N(H,{key:0},{default:m(()=>[s("swiper-container",{class:"movie_list",ref_key:"containerRef",ref:t,loop:!0,"slides-per-view":e(S)},[(i(!0),c(b,null,A(e($),n=>(i(),c("swiper-slide",{class:"movie_item",key:n.id},[d(I,{class:"movie_link",to:`/movies/${n.id}`},{default:m(()=>[s("img",{src:n.poster,alt:"Movie Poster"},null,8,_s)]),_:2},1032,["to"])]))),128))],8,cs)]),_:1})):(i(),c("ul",us,[(i(!0),c(b,null,A(e($),n=>(i(),c("li",{class:"movie_item",key:n.id},[d(I,{class:"movie_link",to:`/movies/${n.id}`},{default:m(()=>[s("img",{src:n.poster,alt:"Movie Poster"},null,8,ds)]),_:2},1032,["to"]),s("button",{class:"movie_remove",onClick:g=>E(n.id)},[d(e(Z))],8,ms)]))),128))]))]),settings:m(()=>{var n,g,M,V,B;return[s("div",ps,[s("ul",vs,[s("li",fs,[s("span",hs,v(`${(n=e(a))==null?void 0:n.name[0].charAt(0).toUpperCase()}${(g=e(a))==null?void 0:g.surname[0].charAt(0).toUpperCase()}`),1),l[0]||(l[0]=s("span",{class:"user_info-title"},"Имя Фамилия",-1)),s("span",ws,v((M=e(a))==null?void 0:M.name)+" "+v((V=e(a))==null?void 0:V.surname),1)]),s("li",ks,[s("span",$s,[d(e(J))]),l[1]||(l[1]=s("span",{class:"user_info-title"},"Электронная почта",-1)),s("span",gs,v((B=e(a))==null?void 0:B.email),1)])]),s("button",{class:"logout-button",onClick:U}," Выйти из аккаунта ")])]}),_:1})}}}),bs=C(ys,[["__scopeId","data-v-d7b375cd"]]),Cs={};function Ps(P,_){const u=bs;return i(),c("div",null,[d(u)])}const As=C(Cs,[["render",Ps],["__scopeId","data-v-92e3c052"]]);export{As as default};
